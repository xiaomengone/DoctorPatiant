import{d as we,u as ce,L as ze,P as Re,m as Xe,c as $e}from"./request-9531ed09.js";import{c as oe,t as H,n as ae,m as O,u as ke,a4 as De,Y as Me,y as Ce,V as ve,W as Pe,X as xe,_ as J,p as ee,a5 as A,w as be,a as Ze,C as p,P as _e,z as Se,a6 as de,a7 as Be,f as Ae,j as fe,d as me,h as Ne,H as He,I as We,s as Ee,e as Le}from"./index-1ce8ca7a.js";import{d as ie,r as F,D as ne,a as S,N as M,j as re,Q as Oe,P as Fe,K as je,c as x,B as ue,m as Ie}from"./index-a79e0a92.js";import{I as Ke}from"./index-ac035123.js";import{c as Te}from"./use-route-0453f8f5.js";const[ye,V]=oe("swipe"),Ue={loop:H,width:ae,height:ae,vertical:Boolean,autoplay:O(0),duration:O(500),touchable:H,lazyRender:Boolean,initialSwipe:O(0),indicatorColor:String,showIndicators:H,stopPropagation:H},Ye=Symbol(ye);var qe=ie({name:ye,props:Ue,emits:["change","dragStart","dragEnd"],setup(e,{emit:v,slots:w}){const t=F(),n=F(),a=ne({rect:null,width:0,height:0,offset:0,active:0,swiping:!1});let z=!1;const h=we(),{children:C,linkChildren:d}=ke(Ye),s=S(()=>C.length),r=S(()=>a[e.vertical?"height":"width"]),f=S(()=>e.vertical?h.deltaY.value:h.deltaX.value),I=S(()=>a.rect?(e.vertical?a.rect.height:a.rect.width)-r.value*s.value:0),Z=S(()=>r.value?Math.ceil(Math.abs(I.value)/r.value):s.value),W=S(()=>s.value*r.value),y=S(()=>(a.active+s.value)%s.value),_=S(()=>{const i=e.vertical?"vertical":"horizontal";return h.direction.value===i}),u=S(()=>{const i={transitionDuration:`${a.swiping?0:e.duration}ms`,transform:`translate${e.vertical?"Y":"X"}(${a.offset}px)`};if(r.value){const m=e.vertical?"height":"width",g=e.vertical?"width":"height";i[m]=`${W.value}px`,i[g]=e[g]?`${e[g]}px`:""}return i}),$=i=>{const{active:m}=a;return i?e.loop?A(m+i,-1,s.value):A(m+i,0,Z.value):m},k=(i,m=0)=>{let g=i*r.value;e.loop||(g=Math.min(g,-I.value));let X=m-g;return e.loop||(X=A(X,I.value,0)),X},R=({pace:i=0,offset:m=0,emitChange:g})=>{if(s.value<=1)return;const{active:X}=a,Y=$(i),U=k(Y,m);if(e.loop){if(C[0]&&U!==I.value){const se=U<I.value;C[0].setOffset(se?W.value:0)}if(C[s.value-1]&&U!==0){const se=U>0;C[s.value-1].setOffset(se?-W.value:0)}}a.active=Y,a.offset=U,g&&Y!==X&&v("change",y.value)},B=()=>{a.swiping=!0,a.active<=-1?R({pace:s.value}):a.active>=s.value&&R({pace:-s.value})},q=()=>{B(),h.reset(),J(()=>{a.swiping=!1,R({pace:-1,emitChange:!0})})},j=()=>{B(),h.reset(),J(()=>{a.swiping=!1,R({pace:1,emitChange:!0})})};let G;const E=()=>clearTimeout(G),L=()=>{E(),+e.autoplay>0&&s.value>1&&(G=setTimeout(()=>{j(),L()},+e.autoplay))},N=(i=+e.initialSwipe)=>{if(!t.value)return;const m=()=>{var g,X;if(!ve(t)){const Y={width:t.value.offsetWidth,height:t.value.offsetHeight};a.rect=Y,a.width=+((g=e.width)!=null?g:Y.width),a.height=+((X=e.height)!=null?X:Y.height)}s.value&&(i=Math.min(s.value-1,i),i===-1&&(i=s.value-1)),a.active=i,a.swiping=!0,a.offset=k(i),C.forEach(Y=>{Y.setOffset(0)}),L()};ve(t)?ue().then(m):m()},T=()=>N(a.active);let Q;const o=i=>{!e.touchable||i.touches.length>1||(h.start(i),z=!1,Q=Date.now(),E(),B())},l=i=>{e.touchable&&a.swiping&&(h.move(i),_.value&&(!e.loop&&(a.active===0&&f.value>0||a.active===s.value-1&&f.value<0)||(ee(i,e.stopPropagation),R({offset:f.value}),z||(v("dragStart",{index:y.value}),z=!0))))},c=()=>{if(!e.touchable||!a.swiping)return;const i=Date.now()-Q,m=f.value/i;if((Math.abs(m)>.25||Math.abs(f.value)>r.value/2)&&_.value){const X=e.vertical?h.offsetY.value:h.offsetX.value;let Y=0;e.loop?Y=X>0?f.value>0?-1:1:0:Y=-Math[f.value>0?"ceil":"floor"](f.value/r.value),R({pace:Y,emitChange:!0})}else f.value&&R({pace:0});z=!1,a.swiping=!1,v("dragEnd",{index:y.value}),L()},P=(i,m={})=>{B(),h.reset(),J(()=>{let g;e.loop&&i===s.value?g=a.active===0?0:i:g=i%s.value,m.immediate?J(()=>{a.swiping=!1}):a.swiping=!1,R({pace:g-a.active,emitChange:!0})})},b=(i,m)=>{const g=m===y.value,X=g?{backgroundColor:e.indicatorColor}:void 0;return x("i",{style:X,class:V("indicator",{active:g})},null)},D=()=>{if(w.indicator)return w.indicator({active:y.value,total:s.value});if(e.showIndicators&&s.value>1)return x("div",{class:V("indicators",{vertical:e.vertical})},[Array(s.value).fill("").map(b)])};return ce({prev:q,next:j,state:a,resize:T,swipeTo:P}),d({size:r,props:e,count:s,activeIndicator:y}),M(()=>e.initialSwipe,i=>N(+i)),M(s,()=>N(a.active)),M(()=>e.autoplay,L),M([Pe,xe,()=>e.width,()=>e.height],T),M(De(),i=>{i==="visible"?L():E()}),re(N),Oe(()=>N(a.active)),Me(()=>N(a.active)),Fe(E),je(E),Ce("touchmove",l,{target:n}),()=>{var i;return x("div",{ref:t,class:V()},[x("div",{ref:n,style:u.value,class:V("track",{vertical:e.vertical}),onTouchstartPassive:o,onTouchend:c,onTouchcancel:c},[(i=w.default)==null?void 0:i.call(w)]),D()])}}});const Ge=be(qe),[Qe,Je]=oe("swipe-item");var pe=ie({name:Qe,setup(e,{slots:v}){let w;const t=ne({offset:0,inited:!1,mounted:!1}),{parent:n,index:a}=Ze(Ye);if(!n)return;const z=S(()=>{const d={},{vertical:s}=n.props;return n.size.value&&(d[s?"height":"width"]=`${n.size.value}px`),t.offset&&(d.transform=`translate${s?"Y":"X"}(${t.offset}px)`),d}),h=S(()=>{const{loop:d,lazyRender:s}=n.props;if(!s||w)return!0;if(!t.mounted)return!1;const r=n.activeIndicator.value,f=n.count.value-1,I=r===0&&d?f:r-1,Z=r===f&&d?0:r+1;return w=a.value===r||a.value===I||a.value===Z,w}),C=d=>{t.offset=d};return re(()=>{ue(()=>{t.mounted=!0})}),ce({setOffset:C}),()=>{var d;return x("div",{class:Je(),style:z.value},[h.value?(d=v.default)==null?void 0:d.call(v):null])}}});const Ve=be(pe),he=e=>Math.sqrt((e[0].clientX-e[1].clientX)**2+(e[0].clientY-e[1].clientY)**2),et=e=>({x:(e[0].clientX+e[1].clientX)/2,y:(e[0].clientY+e[1].clientY)/2}),le=oe("image-preview")[1],ge=2.6;var tt=ie({props:{src:String,show:Boolean,active:Number,minZoom:p(ae),maxZoom:p(ae),rootWidth:p(Number),rootHeight:p(Number),disableZoom:Boolean,closeOnClickOverlay:Boolean},emits:["scale","close","longPress"],setup(e,{emit:v,slots:w}){const t=ne({scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,initializing:!1,imageRatio:0}),n=we(),a=F(),z=F(),h=F(!1),C=F(!1);let d=0;const s=S(()=>{const{scale:o,moveX:l,moveY:c,moving:P,zooming:b,initializing:D}=t,i={transitionDuration:b||P||D?"0s":".3s"};return(o!==1||C.value)&&(i.transform=`matrix(${o}, 0, 0, ${o}, ${l}, ${c})`),i}),r=S(()=>{if(t.imageRatio){const{rootWidth:o,rootHeight:l}=e,c=h.value?l/t.imageRatio:o;return Math.max(0,(t.scale*c-o)/2)}return 0}),f=S(()=>{if(t.imageRatio){const{rootWidth:o,rootHeight:l}=e,c=h.value?l:o*t.imageRatio;return Math.max(0,(t.scale*c-l)/2)}return 0}),I=(o,l)=>{var c;if(o=A(o,+e.minZoom,+e.maxZoom+1),o!==t.scale){const P=o/t.scale;if(t.scale=o,l){const b=Se((c=a.value)==null?void 0:c.$el),D={x:b.width*.5,y:b.height*.5},i=t.moveX-(l.x-b.left-D.x)*(P-1),m=t.moveY-(l.y-b.top-D.y)*(P-1);t.moveX=A(i,-r.value,r.value),t.moveY=A(m,-f.value,f.value)}else t.moveX=0,t.moveY=C.value?d:0;v("scale",{scale:o,index:e.active})}},Z=()=>{I(1)},W=()=>{const o=t.scale>1?1:2;I(o,o===2||C.value?{x:n.startX.value,y:n.startY.value}:void 0)};let y,_,u,$,k,R,B,q,j=!1;const G=o=>{const{touches:l}=o;if(y=l.length,y===2&&e.disableZoom)return;const{offsetX:c}=n;n.start(o),_=t.moveX,u=t.moveY,q=Date.now(),j=!1,t.moving=y===1&&(t.scale!==1||C.value),t.zooming=y===2&&!c.value,t.zooming&&($=t.scale,k=he(l))},E=o=>{const{touches:l}=o;if(n.move(o),t.moving){const{deltaX:c,deltaY:P}=n,b=c.value+_,D=P.value+u;if((b>r.value||b<-r.value)&&!j&&n.isHorizontal()){t.moving=!1;return}j=!0,ee(o,!0),t.moveX=A(b,-r.value,r.value),t.moveY=A(D,-f.value,f.value)}if(t.zooming&&(ee(o,!0),l.length===2)){const c=he(l),P=$*c/k;R=et(l),I(P,R)}},L=o=>{var l;if(y>1)return;const{offsetX:c,offsetY:P}=n,b=Date.now()-q,D=250;if(c.value<de&&P.value<de)if(b<D)if(B)clearTimeout(B),B=null,W();else{if(!e.closeOnClickOverlay&&o.target===((l=z.value)==null?void 0:l.$el))return;B=setTimeout(()=>{v("close"),B=null},D)}else b>Be&&v("longPress")},N=o=>{let l=!1;if((t.moving||t.zooming)&&(l=!0,t.moving&&_===t.moveX&&u===t.moveY&&(l=!1),!o.touches.length)){t.zooming&&(t.moveX=A(t.moveX,-r.value,r.value),t.moveY=A(t.moveY,-f.value,f.value),t.zooming=!1),t.moving=!1,_=0,u=0,$=1,t.scale<1&&Z();const c=+e.maxZoom;t.scale>c&&I(c,R)}ee(o,l),L(o),n.reset()},T=()=>{const{rootWidth:o,rootHeight:l}=e,c=l/o,{imageRatio:P}=t;h.value=t.imageRatio>c&&P<ge,C.value=t.imageRatio>c&&P>=ge,C.value&&(d=(P*o-l)/2,t.moveY=d,t.initializing=!0,_e(()=>{t.initializing=!1})),Z()},Q=o=>{const{naturalWidth:l,naturalHeight:c}=o.target;t.imageRatio=c/l,T()};return M(()=>e.active,Z),M(()=>e.show,o=>{o||Z()}),M(()=>[e.rootWidth,e.rootHeight],T),Ce("touchmove",E,{target:S(()=>{var o;return(o=z.value)==null?void 0:o.$el})}),()=>{const o={loading:()=>x(ze,{type:"spinner"},null)};return x(Ve,{ref:z,class:le("swipe-item"),onTouchstartPassive:G,onTouchend:N,onTouchcancel:N},{default:()=>[w.image?x("div",{class:le("image-wrap")},[w.image({src:e.src})]):x(Ke,{ref:a,src:e.src,fit:"contain",class:le("image",{vertical:h.value}),style:s.value,onLoad:Q},o)]})}}});const[at,K]=oe("image-preview"),ot=["show","teleport","transition","overlayStyle","closeOnPopstate"],it={show:Boolean,loop:H,images:Ae(),minZoom:O(1/3),maxZoom:O(3),overlay:H,closeable:Boolean,showIndex:H,className:fe,closeIcon:me("clear"),transition:String,beforeClose:Function,overlayClass:fe,overlayStyle:Object,swipeDuration:O(300),startPosition:O(0),showIndicators:Boolean,closeOnPopstate:H,closeOnClickOverlay:H,closeIconPosition:me("top-right"),teleport:[String,Object]};var nt=ie({name:at,props:it,emits:["scale","close","closed","change","longPress","update:show"],setup(e,{emit:v,slots:w}){const t=F(),n=ne({active:0,rootWidth:0,rootHeight:0,disableZoom:!1}),a=()=>{if(t.value){const u=Se(t.value.$el);n.rootWidth=u.width,n.rootHeight=u.height,t.value.resize()}},z=u=>v("scale",u),h=u=>v("update:show",u),C=()=>{Te(e.beforeClose,{args:[n.active],done:()=>h(!1)})},d=u=>{u!==n.active&&(n.active=u,v("change",u))},s=()=>{if(e.showIndex)return x("div",{class:K("index")},[w.index?w.index({index:n.active}):`${n.active+1} / ${e.images.length}`])},r=()=>{if(w.cover)return x("div",{class:K("cover")},[w.cover()])},f=()=>{n.disableZoom=!0},I=()=>{n.disableZoom=!1},Z=()=>x(Ge,{ref:t,lazyRender:!0,loop:e.loop,class:K("swipe"),duration:e.swipeDuration,initialSwipe:e.startPosition,showIndicators:e.showIndicators,indicatorColor:"white",onChange:d,onDragEnd:I,onDragStart:f},{default:()=>[e.images.map((u,$)=>x(tt,{src:u,show:e.show,active:n.active,maxZoom:e.maxZoom,minZoom:e.minZoom,rootWidth:n.rootWidth,rootHeight:n.rootHeight,disableZoom:n.disableZoom,closeOnClickOverlay:e.closeOnClickOverlay,onScale:z,onClose:C,onLongPress:()=>v("longPress",{index:$})},{image:w.image}))]}),W=()=>{if(e.closeable)return x(We,{role:"button",name:e.closeIcon,class:[K("close-icon",e.closeIconPosition),He],onClick:C},null)},y=()=>v("closed"),_=(u,$)=>{var k;return(k=t.value)==null?void 0:k.swipeTo(u,$)};return ce({swipeTo:_}),re(a),M([Pe,xe],a),M(()=>e.startPosition,u=>d(+u)),M(()=>e.show,u=>{const{images:$,startPosition:k}=e;u?(d(+k),ue(()=>{a(),_(+k,{immediate:!0})})):v("close",{index:n.active,url:$[n.active]})}),()=>x(Re,Ie({class:[K(),e.className],overlayClass:[K("overlay"),e.overlayClass],onClosed:y,"onUpdate:show":h},Ne(e,ot)),{default:()=>[W(),Z(),s(),r()]})}});let te;const st={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeOnClickOverlay:!0,closeIconPosition:"top-right"};function lt(){({instance:te}=Xe({setup(){const{state:e,toggle:v}=$e(),w=()=>{e.images=[]};return()=>x(nt,Ie(e,{onClosed:w,"onUpdate:show":v}),null)}}))}const Ct=(e,v=0)=>{if(Ee)return te||lt(),e=Array.isArray(e)?{images:e,startPosition:v}:e,te.open(Le({},st,e)),te};var ct=(e=>(e[e.consultDoctor=1]="consultDoctor",e[e.rapidConsultation=2]="rapidConsultation",e[e.MedicationConsultation=3]="MedicationConsultation",e))(ct||{}),rt=(e=>(e[e.week=1]="week",e[e.months=2]="months",e[e.halfYear=3]="halfYear",e[e.year=4]="year",e))(rt||{}),ut=(e=>(e[e.toBePaid=1]="toBePaid",e[e.waitingForConsultation=2]="waitingForConsultation",e[e.inConsultation=3]="inConsultation",e[e.completed=4]="completed",e[e.canceled=5]="canceled",e[e.toBeShipped=11]="toBeShipped",e[e.toBeReceived=12]="toBeReceived",e))(ut||{}),vt=(e=>(e[e.MsgText=1]="MsgText",e[e.MsgImage=4]="MsgImage",e[e.CardPat=21]="CardPat",e[e.CardPre=22]="CardPre",e[e.CardEvaForm=23]="CardEvaForm",e[e.CardEva=24]="CardEva",e[e.Notify=31]="Notify",e[e.NotifyTip=32]="NotifyTip",e[e.NotifyCancel=33]="NotifyCancel",e))(vt||{}),dt=(e=>(e[e.ConsultPay=1]="ConsultPay",e[e.ConsultWait=2]="ConsultWait",e[e.ConsultChat=3]="ConsultChat",e[e.ConsultComplete=4]="ConsultComplete",e[e.ConsultCancel=5]="ConsultCancel",e[e.MedicinePay=10]="MedicinePay",e[e.MedicineSend=11]="MedicineSend",e[e.MedicineTake=12]="MedicineTake",e[e.MedicineComplete=13]="MedicineComplete",e[e.MedicineCancel=14]="MedicineCancel",e))(dt||{});export{ut as E,vt as M,dt as O,Ve as S,Ge as a,rt as b,ct as e,Ct as s};
